[[schema-directives]]
= Directives

== `@cypher`
GraphQL schema directive that can be used to bind a GraphQL field to the results of a Cypher query. For example, letâ€™s add a field `similarMovies` to our Movie, which is bound to a Cypher query, to find other movies with an overlap of actors;

[source, graphql]
----
type Actor {
    actorId: ID!
    name: String
    movies: [Movie] @relationship(type: "ACTED_IN", direction: "OUT")
}

type Movie {
    movieId: ID!
    title: String
    description: String
    year: Int
    actors(limit: Int = 10): [Actor]
        @relationship(type: "ACTED_IN", direction: "IN")
    similarMovies(limit: Int = 10): [Movie]
        @cypher(
            statement: """
            MATCH (this)<-[:ACTED_IN]-(:Actor)-[:ACTED_IN]->(rec:Movie)
            WITH rec, COUNT(*) AS score ORDER BY score DESC
            RETURN rec LIMIT $limit
            """
        )
}
----

=== `@cypher` statement globals
Global variables available inside the @cypher statement.

1. this - bound to the currently resolved node
2. auth - See below


==== Auth global

[source, typescript]
----
interface Auth {
    isAuthenticated: boolean;
    roles?: string[];
    jwt: any;
}
----

=== `@cypher` directive on Query

[source, graphql]
----
type Actor {
    actorId: ID!
    name: String
}

type Query {
    allActors: [Actor]
        @cypher(
            statement: """
            MATCH (a:Actor)
            RETURN a
            """
        )
}
----

=== `@cypher` directive on Mutation

[source, graphql]
----
type Actor {
    actorId: ID!
    name: String
}

type Mutation {
    createActor(name: String!): Actor
        @cypher(
            statement: """
            CREATE (a:Actor {name: $name})
            RETURN a
            """
        )
}
----


=== Returning from the `@cypher` statement
You should return a single value representing corresponding type;

==== Primitives

[source, graphql]
----
type Query {
    randomNumber: Int @cypher(statement: "RETURN rand()")
}
----


==== Nodes

[source, graphql]
----
type Query {
    users: [User]
        @cypher(
            statement: """
            MATCH (u:User)
            RETURN u
            """
        )
}
----


==== Objects

[source, graphql]
----
type User {
    id
}

type Query {
    users: [User] @cypher(statement: """
        MATCH (u:User)
        RETURN {
            id: u.id
        }
    """)
}
----

== `@relationship`

== `@exclude`

== `@auth`

== `@autogenerate`

== `@private`

== `@readonly`

== `@writeonly`

== `@ignore`

== `@default`

== `@coalesce`