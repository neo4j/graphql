FROM node:12.16.3

WORKDIR /app/

## ROOT
COPY ./jest-global.config.js ./jest-global.config.js
COPY ./jest-global.setup.js ./jest-global.setup.js
COPY ./tsconfig.json ./tsconfig.json

## PACKAGE
COPY ./packages/graphql/package.json ./packages/graphql/package.json
COPY ./packages/graphql/tsconfig.json ./packages/graphql/tsconfig.json
COPY ./packages/graphql/jest.config.js ./packages/graphql/jest.config.js
COPY ./packages/graphql/tests/ ./packages/graphql/tests/
COPY ./packages/graphql/src/ ./packages/graphql/src/

WORKDIR /app/packages/graphql

RUN npm i

CMD ["npm", "run", "test:int"]